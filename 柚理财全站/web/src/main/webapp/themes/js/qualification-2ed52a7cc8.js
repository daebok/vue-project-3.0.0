webpackJsonp([21],{0:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function l(e){n["default"].error({title:e,okText:"\u5173\u95ed",wrapClassName:"tiperror"})}function r(e,t,a){a||(a="\u70b9\u51fb\u8df3\u8f6c"),n["default"].error({title:"\u6e29\u99a8\u63d0\u793a",content:e,okText:a,iconType:"question-circle",align:{top:"200px"},onOk:function(){window.location.href=t},onCancel:function(){}})}var o=a(3),n=i(o);a(8);var s=a(2),u=i(s),p=a(1),d=i(p);a(108);var c=a(292),f=i(c),m=$("body").data("flag");m.result||r(m.msg,m.url,m.buttonName);var h=d["default"].createClass({displayName:"List",formArray:[],acceptName:[],getInitialState:function(){return{data:""}},submit:function(){var e=!0,t="",a={qualificationTypes:[]};console.log(this.formArray),$.each(this.formArray,function(i,l){return!l.picpath.length&&"2"==l.status||!l.picpath.length&&"99"==l.status?(e=!1,t=l.name,!1):void(l.picpath.length&&(a[l.field]=l.picpath,a.qualificationTypes[i]=l.field))}),a[$("body").data("tokenname")]=$("body").data("token"),e?$.ajax({url:"/borrow/addFiles.html",type:"POST",dataType:"json",data:a}).done(function(e){e.result?window.location.href="/borrow/addBorrowPage.html":l(e.msg)}).fail(function(){l("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5\uff01")}):l("\u8bf7\u4e0a\u4f20"+t+"\u8bc1\u660e")},getInfo:function(){var e=this;$.ajax({url:"/member/usercertification/getCertificateInfo.html",type:"POST",dataType:"json"}).done(function(t){e.setState({data:t.qualificationList})}).fail(function(){l("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5\uff01")})},componentDidMount:function(){this.getInfo()},setArray:function(e,t,a,i,l){this.formArray[a]={field:e,name:t,picpath:i,status:l}},render:function(){var e=this.state.data;if(!e)return!1;var t=this;return d["default"].createElement("div",null,d["default"].createElement("ul",{className:"list-ul"},e.map(function(e,a){return d["default"].createElement(f["default"],{key:a,eq:a,data:e,setArray:t.setArray,formArray:t.formArray,len:5})})),d["default"].createElement("div",{className:"btn"},d["default"].createElement("a",{href:"javascript:",onClick:this.submit,className:"subbutton"},"\u786e\u5b9a\u63d0\u4ea4")))}});u["default"].render(d["default"].createElement(h,null),document.getElementById("j-qualification"))},108:534,197:534,198:534,199:534,292:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function l(e){o["default"].error({title:e,okText:"\u5173\u95ed",wrapClassName:"tiperror"})}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),o=i(r),n=a(1),s=i(n),u=a(2);i(u);a(199),a(198),a(197);var p=s["default"].createClass({displayName:"Imgupload",image_server_url:$("#header").data("url"),componentDidMount:function(){var e=this,t=this.props.len;this.uploadLimit=t-$(".filelist").eq(this.props.eq).find("li").size(),$("#file_upload"+this.props.eq).uploadify({fileObjName:"upload",buttonClass:"uploadBtn",buttonText:"",fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png",fileSizeLimit:"1024",uploadLimit:e.uploadLimit,width:72,height:72,swf:"/themes/plugins/uploadify/uploadify.swf",uploader:e.image_server_url+"/upload/uploadifySave.html?nid=userinfo",onSelectError:function(e,a,i){var r;return a==-110?r="\u4e0a\u4f20\u7684\u5355\u5f20\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc71M\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20":a==-100?r="\u4e0a\u4f20\u7684\u56fe\u7247\u6700\u591a\u4e0d\u80fd\u8d85\u8fc7"+t+"\u5f20":a==-130&&(r="\u9009\u62e9\u7684\u6587\u4ef6\u7c7b\u578b\u8ddf\u8bbe\u7f6e\u7684\u4e0d\u5339\u914d"),l(r),!1},overrideEvents:["onDialogClose","onUploadSuccess","onUploadError","onSelectError","onSelectOnce"],onUploadSuccess:function(t,a,i){null!=a&&("error"==a?l("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25,\u652f\u6301jpg\u3001jpeg\u3001bmp\u3001gif\u3001png\u683c\u5f0f\u56fe\u7247\uff0c\u5927\u5c0f\u4e0d\u8d85\u8fc71M"):($(".filelist").eq(e.props.eq).append("<li data-imgsrc='"+a+"'><a href='"+e.image_server_url+a+"' class='fileshow'><img src='"+e.image_server_url+a+"' width='110px' height='110px' /></a><span class='operation'><i data-imggroup data-fancybox-group='group"+e.props.eq+"' href='"+e.image_server_url+a+"' class='iconfont showimg' >&#xe67f;</i><i class='iconfont delImg' title='\u70b9\u51fb\u5220\u9664\u56fe\u7247'>&#xe67e;</i><span></li>"),e.updateArray(a),e.uploadControl()))}}),$(".imgupload").eq(this.props.eq).on("click",".filelist li .delImg",function(t){e.deletePic($(this).parents("li").data("imgsrc"),$(this).parents("[data-imgsrc]"))}),$(".filelist").eq(e.props.eq).find("[data-imggroup]").fancybox(),e.uploadControl(),"0"==this.props.data.status&&this.uploadHide()},deletePic:function(e,t){var a=this;$.ajax({url:"/member/usercertification/deletePic.html",type:"POST",dataType:"json",data:{picPath:e}}).done(function(){t.remove(),$("#file_upload"+a.props.eq).uploadify("settings","uploadLimit",++a.uploadLimit),a.props.formArray[a.props.eq].picpath.remove(e),setTimeout(function(){a.uploadControl()},300)}).fail(function(){l("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5\uff01")})},updateArray:function(e){this.props.formArray[this.props.eq].picpath.push(e)},uploadControl:function(){var e=$(".filelist").eq(this.props.eq),t=$("#file_upload"+this.props.eq);e.find("li").length>=this.props.len?t.css("visibility","hidden"):t.css("visibility","visible")},uploadHide:function(){var e=$("#file_upload"+this.props.eq);e.css("visibility","hidden")},render:function(){var e=this,t=this.props.data?this.props.data:[];this.props.setArray(t.qualificationType,t.name,this.props.eq,[],t.status);var a=t.fileList?t.fileList:[];return s["default"].createElement("li",{className:"list-li"},s["default"].createElement("div",{className:"title"},this.props.data.name),s["default"].createElement("div",{className:"upload"},s["default"].createElement("span",{className:"upload-explain"},"\u683c\u5f0f\u8981\u6c42\uff1a\u652f\u6301jpg\u3001jpeg\u3001bmp\u3001gif\u3001png\u683c\u5f0f\u56fe\u7247\uff0c\u5927\u5c0f\u4e0d\u8d85\u8fc71M\u3002"),s["default"].createElement("div",{className:"upload-list"},s["default"].createElement("div",{className:"imgupload"},s["default"].createElement("ul",{className:"filelist"},a.map(function(t,a){return s["default"].createElement("li",{key:a},s["default"].createElement("img",{src:e.image_server_url+t.filePath}),s["default"].createElement("span",{className:"operation"},s["default"].createElement("i",{"data-imggroup":!0,"data-fancybox-group":"group"+e.props.eq,href:e.image_server_url+t.filePath,className:"iconfont showimg"},"\ue67f")))})),s["default"].createElement("div",{id:"file_upload"+this.props.eq})))),s["default"].createElement("div",{className:"imgdemo"},s["default"].createElement("span",{className:"upload-explain"},"\u793a\u4f8b"),s["default"].createElement("div",{className:"demoimg"},s["default"].createElement("img",{src:"http://www.atool.org/include/placeholder_cache/93741aa0ae53dfe5e40e7922342cf3a3.png"}))))}});t["default"]=p,e.exports=t["default"]}});